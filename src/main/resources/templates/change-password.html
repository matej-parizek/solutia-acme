<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/emptyLayout}">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title th:text="#{settings.password.title}">Change password</title>
    <style>
        body { background-color: #e7e3e3; }
        .container { max-width: 500px; margin: 50px auto; background:#fff; padding:20px;
          border-radius:8px; box-shadow:0 4px 6px rgba(0,0,0,.1); }
        h2 { text-align:center; margin-bottom:20px; }
        .form-group { margin-bottom: 15px; }
        label { display:block; margin-bottom:6px; font-weight:600; }
        input[type="password"] { width:100%; padding:10px; border:1px solid #ccc; border-radius:4px; }
        .is-invalid { border-color:#dc3545 !important; }
        .error-message { color:#dc3545; margin-top:6px; font-size:.9em; }
        .global-errors { background:#ffe6e6; color:#a70000; border:1px solid #ffb3b3;
          padding:10px; border-radius:6px; margin-bottom:15px; font-size:.95em; }
        .actions { text-align:center; margin-top:20px; }
        button { background:#007bff; color:#fff; padding:10px 20px; border:none; border-radius:4px; cursor:pointer; }
        button:hover { background:#0056b3; }
        .note { margin-top:10px; text-align:center; color:#666; font-size:.9em; }
    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="container" th:object="${form}">
        <h2 th:text="#{settings.password.title}">Change password</h2>

        <div th:with="globalErrs=${#fields.globalErrors()}"
             th:if="${globalErrs != null and !#lists.isEmpty(globalErrs)}"
             class="global-errors">
            <ul>
                <li th:each="err : ${globalErrs}" th:text="${err}">Invalid username or password</li>
            </ul>
        </div>

        <form th:action="@{/settings/password}" method="post">

            <div class="form-group">
                <label for="currentPassword" th:text="#{password.current.label}">Current password</label>
                <input type="password" id="currentPassword" th:field="*{currentPassword}"
                       th:classappend="${#fields.hasErrors('currentPassword')} ? ' is-invalid'">
                <div class="error-message" th:if="${#fields.hasErrors('currentPassword')}"
                     th:errors="*{currentPassword}">Current password error</div>
            </div>

            <div class="form-group">
                <label for="newPassword" th:text="#{password.new.label}">New password</label>
                <input type="password" id="newPassword" th:field="*{newPassword}"
                       th:classappend="${#fields.hasErrors('newPassword')} ? ' is-invalid'">
                <div class="error-message" th:if="${#fields.hasErrors('newPassword')}"
                     th:errors="*{newPassword}">New password error</div>
            </div>

            <div class="form-group">
                <label for="confirmNewPassword" th:text="#{password.confirm.label}">Confirm new password</label>
                <input type="password" id="confirmNewPassword" th:field="*{confirmNewPassword}"
                       th:classappend="${#fields.hasErrors('confirmNewPassword')} ? ' is-invalid'">
                <div class="error-message" th:if="${#fields.hasErrors('confirmNewPassword')}"
                     th:errors="*{confirmNewPassword}">Confirm new password error</div>
            </div>

            <div class="actions">
                <button type="submit" th:text="#{password.submit}">Save</button>
            </div>

            <div class="note">
                <span th:text="#{settings.password.note}">After saving youâ€™ll be redirected back to this page.</span>
            </div>
        </form>
    </div>
</div>
</body>
</html>
